(function(e){function t(t){for(var i,n,o=t[0],l=t[1],u=t[2],d=0,c=[];d<o.length;d++)n=o[d],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&c.push(a[n][0]),a[n]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);m&&m(t);while(c.length)c.shift()();return s.push.apply(s,u||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],i=!0,o=1;o<r.length;o++){var l=r[o];0!==a[l]&&(i=!1)}i&&(s.splice(t--,1),e=n(n.s=r[0]))}return e}var i={},a={app:0},s=[];function n(t){if(i[t])return i[t].exports;var r=i[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=i,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var m=l;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";r("85ec")},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},"4a6c":function(e,t,r){"use strict";r("f34c")},5:function(e,t){},"56d7":function(e,t,r){"use strict";r.r(t),r.d(t,"$axios",(function(){return ot}));r("e260"),r("e6cf"),r("cca6"),r("a79d");var i=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app"},[r("NavBar"),r("div",{staticClass:"container pt-4"},[r("router-view")],1)],1)},s=[],n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"primary"}},[r("b-navbar-brand",{attrs:{href:"/"}},[e._v("Modellflugplatz")]),r("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),r("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[e.isLoggedIn?r("b-navbar-nav",[r("b-nav-item",{attrs:{to:"/sessions"}},[e._v("Flugprotokoll")]),e.user.is_admin?r("b-nav-item",{attrs:{to:"/pilots"}},[e._v("Pilotenübersicht")]):e._e(),e.user.is_admin?r("b-nav-item",{attrs:{to:"/settings"}},[e._v("Einstellungen")]):e._e()],1):e._e(),r("b-navbar-nav",{staticClass:"ml-auto"},[r("b-nav-item-dropdown",{attrs:{disabled:!e.isLoggedIn,id:"user-info",right:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[r("b-avatar",{staticClass:"avatar",attrs:{variant:e.isLoggedIn?"primary":"secondary"}}),e.isLoggedIn?r("b-nav-text",{staticClass:"mx-2"},[e._v(e._s(e.user.name))]):e._e()]},proxy:!0}])},[r("b-dropdown-item",{attrs:{disabled:""}},[e._v("Nutzername: "+e._s(e.user.username))]),r("b-dropdown-item",{attrs:{disabled:""}},[e._v("Rolle: "+e._s(e.user.is_admin?"Admin":"Pilot"))]),r("b-dropdown-divider"),r("b-dropdown-item",{on:{click:e.logout}},[e._v("Abmelden")])],1)],1)],1)],1)},o=[],l=(r("d3b7"),r("2f62")),u=r("bc3a"),m=r.n(u);i["default"].use(l["a"]);var d=new l["a"].Store({state:{status:"",token:localStorage.getItem("token")||"",user:localStorage.getItem("user")||"{}"},actions:{login:function(e,t){var r=e.commit;return new Promise((function(e,i){r("auth_request"),m.a.post("/login",t).then((function(t){var i=t.data.token,a=t.data.user;localStorage.setItem("token",i),localStorage.setItem("user",JSON.stringify(a)),ot.defaults.headers.common["token"]=i,r("auth_success",{token:i,user:a}),e(t)})).catch((function(e){r("auth_error"),localStorage.removeItem("token"),i(e)}))}))},logout:function(e){var t=e.commit;return new Promise((function(e,r){t("logout"),localStorage.removeItem("token"),localStorage.removeItem("user"),delete ot.defaults.headers.common["token"],e(),r()}))}},mutations:{auth_request:function(e){e.status="loading"},auth_success:function(e,t){e.status="success",e.token=t.token,e.user=JSON.stringify(t.user)},auth_error:function(e){e.status="error"},logout:function(e){e.status="",e.token="",e.user="{}"}},getters:{isLoggedIn:function(e){return!!e.token},authStatus:function(e){return e.status},userInfo:function(e){return e.user}}}),c=r("8c4f"),f=c["a"].isNavigationFailure,b=c["a"].NavigationFailureType,p={name:"NavBar",data:function(){return{isLoggedIn:!1,user:{}}},watch:{$route:function(e,t){this.isLoggedIn=d.getters.isLoggedIn;var r=d.getters.userInfo;this.user="{}"==r?{}:JSON.parse(r)}},mounted:function(){this.isLoggedIn=d.getters.isLoggedIn;var e=d.getters.userInfo;this.user="{}"==e?{}:JSON.parse(e)},methods:{logout:function(){var e=this;d.dispatch("logout").then((function(){e.$router.push("/login").catch((function(t){f(t,b.duplicated)&&e.$router.go()}))}))}}},v=p,g=(r("a6bf"),r("2877")),h=Object(g["a"])(v,n,o,!1,null,"77c94792",null),w=h.exports,_={name:"App",components:{NavBar:w}},k=_,x=(r("034f"),Object(g["a"])(k,a,s,!1,null,null,null)),L=x.exports,S=(r("caad"),r("2532"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"admin-panel"},[r("h2",[e._v("Aktive Flugsessions")]),r("b-alert",{attrs:{variant:"danger",show:0==e.sessionsState}},[e._v(" Flugsessions konnten nicht geladen werden! ")]),r("b-overlay",{attrs:{show:e.sessionsLoader,"spinner-type":"grow"}},[r("b-table",{staticClass:"d-none d-sm-table",attrs:{striped:"",items:e.items,fields:e.fieldsDesktop}}),r("b-table",{staticClass:"d-sm-none",attrs:{striped:"",items:e.items,fields:e.fieldsMobile},scopedSlots:e._u([{key:"cell(session_leader)",fn:function(t){return[r("b",[e._v(e._s(t.item.session_leader?"F":""))])]}}])})],1),r("b-alert",{attrs:{show:e.noSessions,variant:"info"}},[e._v(" Zurzeit keine Piloten auf dem Flugplatz ")]),r("p",{staticClass:"font-italic last-ping-info"},[e._v("Letzte Aktualisierung: --:--")]),e.isAdmin?r("div",[r("hr"),r("h2",[e._v("Quicklinks")]),r("div",{staticClass:"d-none d-sm-block"},[r("b-row",{staticClass:"align-items-center text-center",attrs:{cols:"2"}},[r("b-col",{staticClass:"py-2"},[r("b-button",{attrs:{variant:"primary",to:"pilots/new"}},[e._v("Pilot erstellen")])],1),r("b-col",{staticClass:"py-2"},[r("b-button",{attrs:{variant:"primary",to:"sessions"}},[e._v("Protokoll ansehen")])],1),r("b-col",{staticClass:"py-2"},[r("b-button",{attrs:{variant:"primary",to:"settings?rfid_tags"}},[e._v("RFID-Tag hinzufügen")])],1),r("b-col",{staticClass:"py-2"},[r("b-button",{attrs:{variant:"primary",to:"sessions/new"}},[e._v("Flüge nachtragen")])],1),r("b-col",{staticClass:"py-2"},[r("b-button",{attrs:{variant:"primary",to:"pilots"}},[e._v("Pilotenübersicht")])],1),r("b-col",{staticClass:"py-2"},[r("b-button",{attrs:{variant:"primary"}},[e._v("Alle Piloten abmelden")])],1),r("b-col",{staticClass:"py-2"},[r("b-button",{attrs:{variant:"primary",to:"settings"}},[e._v("Einstellungen")])],1)],1)],1),r("b-list-group",{staticClass:"text-center d-sm-none"},[r("b-list-group-item",{attrs:{to:"sessions"}},[e._v("Protokoll ansehen")]),r("b-list-group-item",{attrs:{to:"sessions/new"}},[e._v("Flüge nachtragen")]),r("b-list-group-item",{attrs:{to:"pilots"}},[e._v("Pilotenübersicht")]),r("b-list-group-item",{attrs:{to:"pilots/new"}},[e._v("Pilot erstellen")]),r("b-list-group-item",{attrs:{to:"settings?rfid_tags"}},[e._v("RFID-Tag hinzufügen")]),r("b-list-group-item",{attrs:{to:"settings"}},[e._v("Einstellungen")]),r("b-list-group-item",{attrs:{variant:"danger"}},[e._v("Alle Piloten abmelden")])],1)],1):e._e()],1)}),$=[],y=r("1da1"),P=(r("96cf"),r("ac1f"),r("1276"),{name:"Home",data:function(){return{items:[],fieldsDesktop:[{key:"pilot_id",label:"ID"},{key:"pilot_name",label:"Pilot"},{key:"start_time",label:"Beginn"},{key:"session_leader",label:"Flugleiter",formatter:function(e){return e?"F":""}}],fieldsMobile:[{key:"pilot_name",label:"Pilot"},{key:"start_time",label:"Beginn",formatter:function(e){var t=e.split(":");return t[0]+":"+t[1]}},{key:"session_leader",label:"",formatter:function(e){return e?"F":""}}],noSessions:!1,sessionsLoader:!1,sessionsState:null,isAdmin:!1}},mounted:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.sessionsLoader=!0,r=JSON.parse(e.$store.getters.userInfo),e.isAdmin=r.is_admin,t.next=5,e.$axios.get("/sessions/running").then((function(t){e.items=t.data["sessions"],e.noSessions=0==e.items.length,e.sessionsLoader=!1,e.sessionsState=!0}),(function(t){console.error(t),e.sessionsLoader=!1,e.sessionsState=!1}));case 5:case"end":return t.stop()}}),t)})))()}}),R=P,N=Object(g["a"])(R,S,$,!1,null,null,null),C=N.exports,D=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-container",{staticClass:"mb-3",attrs:{fluid:""}},[r("b-alert",{attrs:{variant:"danger",show:0==e.loginState}},[e._v(" Nutzername oder Passwort falsch! ")]),r("b-row",{attrs:{"align-h":"center"}},[r("b-col",{attrs:{lg:"6"}},[r("b-card",{staticClass:"login-box",attrs:{title:"Login"}},[r("b-form",{attrs:{novalidate:!0},on:{submit:e.onSubmit}},[r("b-form-group",{attrs:{label:"Nutzername","label-for":"userInput"}},[r("b-form-input",{attrs:{type:"text",id:"userInput",state:e.validateState("username")},model:{value:e.$v.form.username.$model,callback:function(t){e.$set(e.$v.form.username,"$model","string"===typeof t?t.trim():t)},expression:"$v.form.username.$model"}}),e.$v.form.username.maxLength?e._e():r("b-form-invalid-feedback",[e._v(" Nutzername zu lang! ")]),r("b-form-invalid-feedback",[e._v(" Ungültiger Nutzername! ")])],1),r("b-form-group",{attrs:{label:"Passwort","label-for":"passwordInput"}},[r("b-form-input",{staticClass:"mb-2",attrs:{type:"password",id:"passwordInput",state:e.validateState("password")},model:{value:e.$v.form.password.$model,callback:function(t){e.$set(e.$v.form.password,"$model","string"===typeof t?t.trim():t)},expression:"$v.form.password.$model"}}),e.$v.form.password.minLength?e._e():r("b-form-invalid-feedback",[e._v(" Passwort zu kurz! ")]),e.$v.form.password.maxLength?e._e():r("b-form-invalid-feedback",[e._v(" Passwort zu lang! ")]),r("b-form-invalid-feedback",[e._v(" Ungültiges Passwort! ")]),e._v(" Noch kein Passwort festgelegt? - "),r("b-link",{attrs:{to:"/signup"}},[e._v("Registrieren")])],1),r("b-button",{staticClass:"float-right",attrs:{type:"submit",variant:"primary",disabled:e.loginLoader}},[r("b-spinner",{directives:[{name:"show",rawName:"v-show",value:e.loginLoader,expression:"loginLoader"}],attrs:{small:""}}),e._v(" Anmelden ")],1)],1)],1)],1)],1)],1)},z=[],T={methods:{validateState:function(e){var t=this.$v.form[e],r=t.$dirty,i=t.$error;return r?!i:null},validateSubmit:function(e){return e.preventDefault(),this.$v.form.$touch(),!this.$v.form.$anyError},onReset:function(e){e.preventDefault()}}},I=r("279c"),A=r.n(I),O={data:function(){return{form:{username:null,password:null}}},methods:{encryptPassword:function(e){var t=A.a.genSaltSync(10);return A.a.hashSync(e,t)}}},j=r("b5ae"),F={name:"Login",mixins:[T,O],data:function(){return{loginLoader:!1,loginState:null}},validations:{form:{username:{required:j["required"],maxLength:Object(j["maxLength"])(100)},password:{required:j["required"],minLength:Object(j["minLength"])(6),maxLength:Object(j["maxLength"])(50)}}},methods:{onSubmit:function(e){this.validateSubmit(e)&&this.postLogin()},postLogin:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.loginLoader=!0,r={username:e.form.username,password:e.form.password},e.$store.dispatch("login",r).then((function(){return e.$router.push("/")})).catch((function(t){console.log(t),e.loginLoader=!1,e.loginState=!1,e.$v.$reset()}));case 3:case"end":return t.stop()}}),t)})))()}}},q=F,U=Object(g["a"])(q,D,z,!1,null,null,null),E=U.exports,M=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-container",{staticClass:"mb-3",attrs:{fluid:""}},[r("b-alert",{attrs:{variant:"success",show:e.signupState}},[e._v(" Pilot wurde erfolgreich registriert!"),r("br"),r("br"),r("b-button",{attrs:{variant:"success",to:"login"}},[e._v(" Weiter zum Login ")])],1),r("b-alert",{attrs:{variant:"danger",show:0==e.signupState}},[e._v(" Pilot konnte nicht registriert werden! Das Passwort wurde bereits vergeben! ")]),r("b-row",{attrs:{"align-h":"center"}},[r("b-col",{attrs:{lg:"6"}},[r("b-card",{staticClass:"signup-box",attrs:{title:"Registrieren"}},[r("b-form",{attrs:{novalidate:!0},on:{submit:e.onSubmit}},[r("b-form-group",{attrs:{label:"Nutzername","label-for":"userInput"}},[r("b-form-input",{attrs:{type:"text",id:"userInput",state:e.validateState("username")},model:{value:e.$v.form.username.$model,callback:function(t){e.$set(e.$v.form.username,"$model","string"===typeof t?t.trim():t)},expression:"$v.form.username.$model"}}),e.$v.form.username.maxLength?e._e():r("b-form-invalid-feedback",[e._v(" Nutzername zu lang! ")]),r("b-form-invalid-feedback",[e._v(" Ungültiger Nutzername! ")])],1),r("b-form-group",{attrs:{label:"Passwort","label-for":"passwordInput"}},[r("b-form-input",{attrs:{type:"password",id:"passwordInput",state:e.validateState("password")},model:{value:e.$v.form.password.$model,callback:function(t){e.$set(e.$v.form.password,"$model","string"===typeof t?t.trim():t)},expression:"$v.form.password.$model"}}),e.$v.form.password.minLength?e._e():r("b-form-invalid-feedback",[e._v(" Passwort zu kurz! ")]),e.$v.form.password.maxLength?e._e():r("b-form-invalid-feedback",[e._v(" Passwort zu lang! ")]),r("b-form-invalid-feedback",[e._v(" Ungültiges Passwort! ")])],1),r("b-form-group",{attrs:{label:"Passwort bestätigen","label-for":"passwordInput"}},[r("b-form-input",{staticClass:"mb-2",attrs:{type:"password",id:"passwordRepeatInput",state:e.validateState("repeatPassword")},model:{value:e.$v.form.repeatPassword.$model,callback:function(t){e.$set(e.$v.form.repeatPassword,"$model","string"===typeof t?t.trim():t)},expression:"$v.form.repeatPassword.$model"}}),r("b-form-invalid-feedback",[e._v(" Die Passwörter müssen identisch sein! ")]),e._v(" Bereits Passwort vergeben? - "),r("b-link",{attrs:{to:"/login"}},[e._v("Anmelden")])],1),r("b-button",{staticClass:"float-right",attrs:{type:"submit",variant:"primary",disabled:e.signupLoader}},[r("b-spinner",{directives:[{name:"show",rawName:"v-show",value:e.signupLoader,expression:"signupLoader"}],attrs:{small:""}}),e._v(" Registrieren ")],1)],1)],1)],1)],1)],1)},B=[],Z={name:"Signup",mixins:[O,T],data:function(){return{signupLoader:!1,signupState:null,form:{repeatPassword:null}}},validations:{form:{username:{required:j["required"],maxLength:Object(j["maxLength"])(100)},password:{required:j["required"],minLength:Object(j["minLength"])(6),maxLength:Object(j["maxLength"])(50)},repeatPassword:{required:j["required"],sameAsPassword:Object(j["sameAs"])("password"),minLength:Object(j["minLength"])(6),maxLength:Object(j["maxLength"])(50)}}},methods:{onSubmit:function(e){this.validateSubmit(e)&&this.postSignup()},postSignup:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.signupLoader=!0,r={username:e.form.username,password:e.encryptPassword(e.form.password)},t.next=4,e.$axios.post("/signup",r).then((function(){e.signupLoader=!1,e.signupState=!0})).catch((function(t){console.log(t),e.$v.$reset(),e.signupLoader=!1,e.signupState=!1}));case 4:case"end":return t.stop()}}),t)})))()}}},G=Z,J=Object(g["a"])(G,M,B,!1,null,null,null),K=J.exports,H=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"pilots"},[r("h2",[e._v("Pilotenübersicht")]),r("b-alert",{attrs:{variant:"success",show:e.deactivateState,dismissible:""}},[e._v(" Pilot wurde erfolgreich deaktiviert! ")]),r("b-alert",{attrs:{variant:"danger",show:0==e.deactivateState,dismissible:""}},[e._v(" "+e._s(e.deactivateMsg)+" ")]),r("b-alert",{attrs:{variant:"danger",show:0==e.pilotsState}},[e._v(" Piloten konnten nicht geladen werden! ")]),r("b-row",{staticClass:"text-center no-gutters mb-2"},[r("b-col",{staticClass:"mb-2 mb-md-0"},[r("b-input-group",{attrs:{prepend:"Suche"}},[r("b-form-input",{attrs:{type:"search",placeholder:"Name"},model:{value:e.pilotName,callback:function(t){e.pilotName=t},expression:"pilotName"}})],1)],1),r("b-col",{attrs:{cols:"12",md:"auto"}},[r("b-button",{staticClass:"ml-md-2",attrs:{variant:"primary"},on:{click:function(t){return e.toggleActivePilots()}}},[e._v(e._s(e.toggleActivePilotsButton))]),r("b-button",{staticClass:"ml-2",attrs:{variant:"success",to:"pilots/new"}},[r("b-icon",{attrs:{icon:"plus",scale:"1.5"}}),e._v(" Pilot erstellen ")],1)],1)],1),r("b-modal",{attrs:{disabled:"",title:"Pilot deaktivieren","header-bg-variant":"danger","header-text-variant":"light"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("b-button",{attrs:{variant:"secondary"},on:{click:function(t){e.showModal=!1}}},[e._v("Abbrechen")]),r("b-button",{attrs:{disabled:e.deactivateLoader,variant:"danger"},on:{click:function(t){return e.deactivatePilot()}}},[r("b-spinner",{directives:[{name:"show",rawName:"v-show",value:e.deactivateLoader,expression:"deactivateLoader"}],attrs:{small:""}}),e._v(" Deaktivieren ")],1)]},proxy:!0}]),model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[e._v(" Soll "+e._s(e.toDeactivatePilot.pilot_name)+" "+e._s(e.toDeactivatePilot.pilot_surname)+" wirklich deaktiviert werden?"),r("br"),r("br"),e._v(" Die Zuweisung des RFID-Ausweises zum Piloten wird aufgehoben und der Ausweis wird als frei markiert. ")]),r("b-overlay",{attrs:{show:e.pilotsLoader,"spinner-type":"grow"}},[r("b-table",{attrs:{stacked:"sm",striped:"",items:e.items,fields:e.fields,filter:e.pilotName},scopedSlots:e._u([{key:"cell(pilot_name)",fn:function(t){return[e._v(" "+e._s(t.item.pilot_name)+" "+e._s(t.item.pilot_surname)+" ")]}},{key:"cell(actions)",fn:function(t){return[e.isActive?r("b-button-group",{attrs:{size:"sm"}},[r("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"outline-primary",href:"/pilots/edit?id="+t.item.pilot_id,title:"Bearbeiten"}},[r("b-icon-pencil-square"),r("span",{staticClass:"d-block d-sm-none"},[e._v("Bearbeiten")])],1),r("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"outline-danger",title:"Deaktivieren"},on:{click:function(r){return e.showDeactivateModal(t.item)}}},[r("b-icon-dash-circle-fill"),r("span",{staticClass:"d-block d-sm-none"},[e._v("Deaktivieren")])],1)],1):r("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{href:"/pilots/reactivate?id="+t.item.pilot_id,size:"sm",variant:"outline-success",title:"Reaktivieren"}},[r("b-icon-plus-circle-fill"),r("span",{staticClass:"d-block d-sm-none"},[e._v("Reaktivieren")])],1)]}}])})],1)],1)},V=[],W={name:"Pilots",data:function(){return{items:[],fields:[{key:"pilot_id",label:"ID"},{key:"pilot_name",label:"Name"},{key:"entry_date",label:"Eintrittsdatum",formatter:function(e){return new Date(e).toLocaleDateString()}},{key:"rfid",label:"RFID",formatter:function(e){return"null"==e?"nicht vergeben":e}},{key:"actions",label:"",class:"text-center"}],toggleActivePilotsButton:"Zeige inaktive Piloten",pilotName:null,isActive:!0,searchInput:null,toDeactivatePilot:[],showModal:!1,pilotsLoader:!1,pilotsState:null,deactivateLoader:!1,deactivateState:null,deactivateMsg:null}},methods:{showDeactivateModal:function(e){this.toDeactivatePilot=e,this.showModal=!0},deactivatePilot:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.deactivateLoader=!0,new Promise((function(t,r){e.$axios.get("/sessions/running").then((function(i){for(var a=i.data["sessions"],s=0;s<a.length;s++)a[s].pilot_id==e.toDeactivatePilot.pilot_id&&(e.deactivateMsg="Pilot konnte nicht deaktiviert werden, da er zurzeit eine Flugsession hat!",r());t()}),(function(t){console.error(t),e.deactivateMsg="Pilot konnte nicht deaktiviert werden!",r()}))})).then((function(){e.toDeactivatePilot.rfid=null,e.$axios.put("/pilots?id="+e.toDeactivatePilot.pilot_id,e.toDeactivatePilot).then((function(t){e.items=t.data["pilots"],e.deactivateState=!0,e.getPilots()}),(function(t){console.error(t),e.deactivateMsg="Pilot konnte nicht deaktiviert werden!",e.deactivateState=!1}))}),(function(t){console.error(t),e.deactivateState=!1})),e.deactivateLoader=!1,e.showModal=!1;case 4:case"end":return t.stop()}}),t)})))()},toggleActivePilots:function(){this.isActive?(this.isActive=!1,this.toggleActivePilotsButton="Zeige aktive Piloten"):(this.isActive=!0,this.toggleActivePilotsButton="Zeige inaktive Piloten"),this.getPilots()},getPilots:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.pilotsLoader=!0,t.next=3,e.$axios.get("/pilots?is_active="+e.isActive).then((function(t){e.items=t.data["pilots"],e.pilotsLoader=!1}),(function(t){console.error(t),e.pilotsLoader=!1,e.pilotsState=!1}));case 3:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getPilots();case 1:case"end":return t.stop()}}),t)})))()}},Q=W,X=Object(g["a"])(Q,H,V,!1,null,null,null),Y=X.exports,ee=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"new-session"},[r("h2",[e._v("Flugsession nachtragen")]),r("b-alert",{attrs:{variant:"danger",show:0==e.pilotListState}},[e._v(" Keine Verbindung zur Datenbank! ")]),r("b-alert",{attrs:{variant:"danger",show:0==e.submitState,dismissable:""}},[e._v(" Flugsession konnte nicht nachgetragen werden! ")]),r("b-alert",{attrs:{variant:"success",show:e.submitState,dismissable:""}},[e._v(" Flugsession wurde erfolgreich nachgetragen! ")]),r("b-form",{attrs:{novalidate:!0},on:{submit:e.onSubmit}},[r("b-row",[r("b-col",{attrs:{cols:"lg-8"}},[r("b-form-group",{attrs:{id:"pilot-name-group",label:"Pilot","label-for":"pilot-name-input"}},[r("b-overlay",{attrs:{show:e.pilotListLoader,"spinner-type":"grow","spinner-small":""}},[r("b-form-input",{staticClass:"mb-3",attrs:{id:"pilot-name-input",placeholder:"Name",type:"search",autocomplete:"off"},model:{value:e.pilotSearch,callback:function(t){e.pilotSearch=t},expression:"pilotSearch"}}),r("b-form-select",{attrs:{options:e.filteredPilotList,"select-size":5,state:e.validateState("pilot")},model:{value:e.$v.form.pilot.$model,callback:function(t){e.$set(e.$v.form.pilot,"$model","string"===typeof t?t.trim():t)},expression:"$v.form.pilot.$model"}}),r("b-form-invalid-feedback",{attrs:{state:e.validateState("pilot")}},[e._v(" Kein Pilot ausgewählt! ")])],1)],1),r("b-row",[r("b-col",{attrs:{cols:"12",md:"6"}},[r("b-form-group",{attrs:{id:"session-start-group",label:"Startzeit","label-for":"session-start-time-input"}},[r("b-form-input",{attrs:{id:"session-start-time-input",state:e.validateState("endTime")&&e.validateState("startTime"),type:"time"},model:{value:e.$v.form.startTime.$model,callback:function(t){e.$set(e.$v.form.startTime,"$model","string"===typeof t?t.trim():t)},expression:"$v.form.startTime.$model"}}),r("b-form-invalid-feedback",[e._v(" Ungültige Zeitangabe! ")])],1)],1),r("b-col",[r("b-form-group",{attrs:{id:"session-end-group",label:"Endzeit","label-for":"session-end-time-input"}},[r("b-form-input",{attrs:{id:"session-end-time-input",state:e.validateState("endTime")&&e.validateState("startTime"),type:"time"},model:{value:e.$v.form.endTime.$model,callback:function(t){e.$set(e.$v.form.endTime,"$model","string"===typeof t?t.trim():t)},expression:"$v.form.endTime.$model"}})],1)],1)],1),r("b-form-group",{attrs:{id:"session-leader-group"}},[r("b-form-checkbox",{attrs:{id:"session-leader-checkbox",name:"session-leader-checkbox"},model:{value:e.form.sessionLeader,callback:function(t){e.$set(e.form,"sessionLeader",t)},expression:"form.sessionLeader"}},[e._v("Flugleiter")])],1),r("b-form-group",{attrs:{id:"guest-check-group"}},[r("b-form-checkbox",{attrs:{id:"guest-checkbox",name:"guest-checkbox"},model:{value:e.form.guest,callback:function(t){e.$set(e.form,"guest",t)},expression:"form.guest"}},[e._v("mit Gast")])],1),r("b-container",{directives:[{name:"show",rawName:"v-show",value:e.form.guest,expression:"form.guest"}]},[r("b-form-group",{attrs:{id:"guest-name-group",label:"Gastname","label-for":"guest-input"}},[r("b-form-input",{attrs:{id:"guest-input",state:e.validateState("guestName")},model:{value:e.$v.form.guestName.$model,callback:function(t){e.$set(e.$v.form.guestName,"$model","string"===typeof t?t.trim():t)},expression:"$v.form.guestName.$model"}}),e.$v.form.guestName.maxLength?e._e():r("b-form-invalid-feedback",[e._v(" Gastname zu lang! ")]),r("b-form-invalid-feedback",[e._v(" Ungültiger Gastname! ")])],1),r("b-form-group",{attrs:{id:"guest-info-group",label:"Gastinformationen","label-for":"guest-textarea"}},[r("b-form-textarea",{attrs:{id:"guest-textarea",state:e.validateState("guestText"),rows:"3"},model:{value:e.$v.form.guestText.$model,callback:function(t){e.$set(e.$v.form.guestText,"$model",t)},expression:"$v.form.guestText.$model"}}),e.$v.form.guestText.maxLength?e._e():r("b-form-invalid-feedback",[e._v(" Gastinformation zu lang! ")])],1)],1)],1),r("b-col",[r("b-form-group",{attrs:{id:"session-date",label:"Datum","label-for":"session-date-picker"}},[r("b-calendar",{class:0==e.validateState("date")?"form_error":"",attrs:{id:"session-date-picker",locale:"de-DE","start-weekday":1,labelHelp:"",labelNoDateSelected:"Kein Datum ausgewählt",max:e.maxDate},model:{value:e.$v.form.date.$model,callback:function(t){e.$set(e.$v.form.date,"$model","string"===typeof t?t.trim():t)},expression:"$v.form.date.$model"}}),r("b-form-invalid-feedback",{attrs:{state:e.validateState("date")}},[e._v(" Kein Datum ausgewählt! ")])],1)],1)],1),r("div",{staticClass:"footer-buttons"},[r("b-button",{attrs:{type:"submit",variant:"primary",disabled:e.submitLoader}},[r("b-spinner",{directives:[{name:"show",rawName:"v-show",value:e.submitLoader,expression:"submitLoader"}],attrs:{small:""}}),e._v(" Speichern ")],1)],1)],1)],1)},te=[],re=(r("159b"),r("07ac"),r("d81d"),{data:function(){return{form:{startTime:"",endTime:"",date:null,sessionLeader:!1,guestName:null,guestText:null}}}}),ie=j["helpers"].regex("guestNameRegex",/^([A-Z][a-záàéèöäüß]+)([- ]([A-Z][a-záàéèöäüß]+))* ([a-z]+ )*([A-Z][a-záàéèöäüß]+)([-]([A-Z][a-záàéèöäüß]+))*$/),ae={name:"NewSession",mixins:[T,re],data:function(){return{form:{sessionLeader:!1,guest:!1,pilot:null},maxDate:new Date,submitLoader:!1,submitState:null,pilotListLoader:!1,pilotListState:null,pilotSearch:null,pilotList:[],filteredPilotList:[]}},validations:function(){var e=this,t={pilot:{required:j["required"]},date:{required:j["required"]},startTime:{required:j["required"]},endTime:{required:j["required"],minValue:function(t){var r=t.split(":"),i=e.form.startTime.split(":");return(new Date).setHours(r[0],r[1])>(new Date).setHours(i[0],i[1])}},guestName:{},guestText:{}};return this.form.guest&&(t.guestName={required:j["required"],guestNameRegex:ie,maxLength:Object(j["maxLength"])(100)},t.guestText={maxLength:Object(j["maxLength"])(300)}),{form:t}},methods:{onSubmit:function(e){this.validateSubmit(e)&&this.postNewSession()},postNewSession:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.submitLoader=!0,r={pilot_id:e.form.pilot,session_date:e.form.date,start_time:e.form.startTime,end_time:e.form.endTime,is_leader:e.form.sessionLeader},e.form.guest&&(r["guest_name"]=e.form.guestName,r["guest_info"]=e.form.guestText),t.next=5,e.$axios.post("/sessions",r).then((function(){e.submitLoader=!1,e.submitState=!0})).catch((function(t){console.error(t),e.submitLoader=!1,e.submitState=!1}));case 5:case"end":return t.stop()}}),t)})))()}},watch:{pilotSearch:function(){var e=this;this.filteredPilotList=[],Object.values(this.pilotList).forEach((function(t){t.text.includes(e.pilotSearch)&&e.filteredPilotList.push(t)}))}},mounted:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.pilotListLoader=!0,t.next=3,e.$axios.get("/pilot-list").then((function(t){var r=t.data["pilots"].map((function(e){return{value:e.pilot_id,text:"["+e.pilot_id+"] "+e.pilot_name}}));e.pilotList=r,e.filteredPilotList=r,e.pilotListLoader=!1})).catch((function(t){console.error(t),e.pilotListLoader=!1,e.pilotListState=!1}));case 3:case"end":return t.stop()}}),t)})))()}},se=ae,ne=(r("4a6c"),Object(g["a"])(se,ee,te,!1,null,"00057df2",null)),oe=ne.exports,le=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"edit-session"},[r("h2",[e._v("Flugsession bearbeiten")]),r("b-alert",{attrs:{variant:"danger",show:0==e.submitState,dismissable:""}},[e._v(" Flugsession konnte nicht bearbeitet werden! ")]),r("b-alert",{attrs:{variant:"success",show:e.submitState}},[e._v(" Flugession wurde erfolgreich bearbeitet!"),r("br"),r("br"),e._v(" Weiterleitung zur Protokollübersicht... ")]),r("b-alert",{attrs:{variant:"danger",show:0==e.sessionState}},[e._v(" Die angeforderte Flugsession konnte nicht geladen werden! ")]),r("b-overlay",{attrs:{show:e.sessionLoader}},[r("b-form",{directives:[{name:"show",rawName:"v-show",value:e.sessionState,expression:"sessionState"}],attrs:{novalidate:!0},on:{submit:e.onSubmit}},[r("b-container",[r("b-row",[r("b-col",{attrs:{md:"6",lg:"5"}},[r("h4",[e._v("Informationen")]),r("b-table-simple",[r("b-tbody",[r("b-tr",[r("b-th",{staticClass:"text-right"},[e._v("Pilot")]),r("b-td",[e._v(e._s(e.form.pilotName))])],1),r("b-tr",[r("b-th",{staticClass:"text-right"},[e._v("Datum")]),r("b-td",[e._v(e._s(new Date(e.form.date).toLocaleDateString()))])],1),r("b-tr",[r("b-th",{staticClass:"text-right"},[e._v("Von")]),r("b-td",[e._v(e._s(e.form.startTime))])],1),r("b-tr",[r("b-th",{staticClass:"text-right"},[e._v("Bis")]),r("b-td",[e._v(e._s(e.form.endTime))])],1),r("b-tr",[r("b-th",{staticClass:"text-right"},[e._v("Flugleiter")]),r("b-td",[e._v(e._s(e.form.sessionLeader?"Ja":"Nein"))])],1)],1)],1)],1),r("b-col",[r("h4",[e._v("Gast")]),r("b-form-group",{attrs:{id:"guest-name-group",label:"Gastname","label-for":"guest-input"}},[r("b-form-input",{attrs:{id:"guest-input",state:e.validateState("guestName")},model:{value:e.$v.form.guestName.$model,callback:function(t){e.$set(e.$v.form.guestName,"$model","string"===typeof t?t.trim():t)},expression:"$v.form.guestName.$model"}}),e.$v.form.guestName.maxLength?e._e():r("b-form-invalid-feedback",[e._v(" Gastname zu lang! ")]),r("b-form-invalid-feedback",[e._v(" Ungültiger Gastname! ")])],1),r("b-form-group",{attrs:{id:"guest-info-group",label:"Gastinformationen","label-for":"guest-textarea"}},[r("b-form-textarea",{attrs:{id:"guest-textarea",state:e.validateState("guestText"),rows:"3"},model:{value:e.$v.form.guestText.$model,callback:function(t){e.$set(e.$v.form.guestText,"$model",t)},expression:"$v.form.guestText.$model"}}),e.$v.form.guestText.maxLength?e._e():r("b-form-invalid-feedback",[e._v(" Gastinformation zu lang! ")])],1)],1)],1)],1),r("div",{staticClass:"footer-buttons"},[r("b-button",{attrs:{type:"submit",variant:"primary",disabled:e.submitLoader}},[r("b-spinner",{directives:[{name:"show",rawName:"v-show",value:e.submitLoader,expression:"submitLoader"}],attrs:{small:""}}),e._v(" Speichern ")],1)],1)],1)],1)],1)},ue=[],me=(r("b0c0"),j["helpers"].regex("guestNameRegex",/^([A-Z][a-záàéèöäüß]+)([- ]([A-Z][a-záàéèöäüß]+))* ([a-z]+ )*([A-Z][a-záàéèöäüß]+)([-]([A-Z][a-záàéèöäüß]+))*$/)),de={name:"EditSession",mixins:[T,re],data:function(){return{sessionId:null,sessionLoader:!1,sessionState:null,submitState:null,submitLoader:!1}},validations:{form:{guestName:{required:j["required"],guestNameRegex:me,maxLength:Object(j["maxLength"])(100)},guestText:{maxLength:Object(j["maxLength"])(300)}}},mounted:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.sessionId=e.$route.query.id,e.sessionLoader=!0,t.next=4,e.$axios.get("/sessions?from="+e.sessionId+"&to="+e.sessionId).then((function(t){e.sessionLoader=!1;var r=t.data["sessions"][0];e.form.pilotName=r.pilot_name,e.form.date=r.date,e.form.startTime=r.start_time,e.form.endTime=r.end_time,e.form.sessionLeader=r.session_leader,e.form.guestName=r.guest.name,e.form.guestText=r.guest.text,e.sessionState=!0})).catch((function(t){e.sessionLoader=!1,e.sessionState=!1,console.error(t)}));case 4:case"end":return t.stop()}}),t)})))()},methods:{onSubmit:function(e){this.validateSubmit(e)&&this.editSession()},editSession:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.submitLoader=!0,r={guest_name:e.form.guestName,guest_info:e.form.guestText},t.next=4,e.$axios.put("/sessions?id="+e.sessionId,r).then((function(){e.submitLoader=!1,e.submitState=!0,setTimeout((function(){e.$router.push("/sessions")}),3e3)})).catch((function(t){console.log(t),e.submitLoader=!1,e.submitState=!1}));case 4:case"end":return t.stop()}}),t)})))()}}},ce=de,fe=Object(g["a"])(ce,le,ue,!1,null,null,null),be=fe.exports,pe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"sessions"},[r("h2",[e._v("Protokolldaten")]),r("b-alert",{attrs:{variant:"danger",show:0==e.sessionState}},[e._v(" Protokolldaten konnten nicht geladen werden ")]),r("b-container",{staticClass:"mb-3",attrs:{fluid:""}},[r("b-row",{attrs:{"align-h":"center"}},[r("b-col",{attrs:{lg:"6"}},[r("b-form-group",{attrs:{label:"Name","label-for":"name-filter-input"}},[r("b-form-input",{attrs:{id:"name-filter-input",type:"search"},model:{value:e.pilotName,callback:function(t){e.pilotName=t},expression:"pilotName"}})],1)],1)],1),r("b-row",{attrs:{"align-h":"center"}},[r("b-col",{attrs:{lg:"3"}},[r("b-form-group",{attrs:{label:"Startdatum","label-for":"start-date-filter"}},[r("b-form-datepicker",{attrs:{id:"start-date-filter",placeholder:"Datum auswählen",locale:"de-DE","start-weekday":1,"hide-header":!0,labelHelp:"",max:e.endDate},model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}})],1)],1),r("b-col",{attrs:{lg:"3"}},[r("b-form-group",{attrs:{label:"Enddatum","label-for":"end-date-filter"}},[r("b-form-datepicker",{attrs:{id:"end-date-filter",placeholder:"Datum auswählen",locale:"de-DE","start-weekday":1,"hide-header":!0,labelHelp:"",min:e.startDate,max:e.maxDate},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1)],1)],1),r("b-row",{attrs:{"align-h":"center"}},[r("b-col",{attrs:{lg:"6"}},[r("b-button-group",{staticClass:"float-right"},[r("b-button",{attrs:{pressed:e.filteredSessions,variant:"primary"},on:{click:function(t){e.filteredSessions=!0,e.getSessions()}}},[r("b-icon-filter",{attrs:{"flip-v":e.filteredSessions}}),e._v(" Filtern ")],1),e.filteredSessions?r("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"danger",title:"Filter aufheben"},on:{click:function(t){e.filteredSessions=!1,e.getSessions()}}},[r("b-icon-x",{attrs:{scale:"1.2"}})],1):e._e()],1)],1)],1)],1),r("b-pagination",{staticClass:"d-md-none",attrs:{"total-rows":e.sessionCount,"per-page":e.perPage},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}),r("b-overlay",{attrs:{show:e.sessionLoader,"spinner-type":"grow"}},[r("b-table",{staticClass:"d-none d-md-table",attrs:{stacked:"sm",striped:"",items:e.items,fields:e.fieldsDesktop,"current-page":e.currentPage},scopedSlots:e._u([{key:"cell(guest_details)",fn:function(t){return[t.item.guest.name?r("b-button",{attrs:{variant:"outline-dark",size:"sm"},on:{click:t.toggleDetails}},[e._v(e._s(t.item.guest.name))]):e._e()]}},{key:"row-details",fn:function(t){return[r("b-card",{attrs:{"sub-title":"Gast: "+t.item.guest.name}},[e._v(" "+e._s(t.item.guest.text)+" ")])]}},{key:"cell(actions)",fn:function(t){return[e.canEdit(t.item.pilot_id)?r("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{href:"/sessions/edit?id="+t.item.session_id,size:"sm",variant:"outline-primary",title:"Bearbeiten"}},[r("b-icon-pencil-square")],1):e._e()]}}])}),r("b-table",{staticClass:"d-md-none",attrs:{stacked:"",striped:"",items:e.items,fields:e.fieldsMobile},scopedSlots:e._u([{key:"cell(session_time)",fn:function(t){return[e._v(" "+e._s(t.item.start_time)+" - "+e._s(null==t.item.end_time?"offen":t.item.end_time)+" ")]}},{key:"cell(guest)",fn:function(t){return[e._v(" "+e._s(null!=t.item.guest.name?t.item.guest.name:"Kein Gast")),r("br"),e._v(" "+e._s(null!=t.item.guest.name?t.item.guest.text:"")+" ")]}},{key:"cell(actions)",fn:function(t){return[e.canEdit(t.item.pilot_id)?r("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{href:"/sessions/edit?id="+t.item.session_id,size:"sm",variant:"outline-primary",title:"Bearbeiten"}},[r("b-icon-pencil-square"),r("span",{staticClass:"d-block d-sm-none"},[e._v("Bearbeiten")])],1):e._e()]}}])})],1),r("b-pagination",{attrs:{"total-rows":e.sessionCount,"per-page":e.perPage},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}),r("p",{staticClass:"font-italic last-ping-info"},[e._v("Letzte Aktualisierung: --:--")]),e.userInfo.is_admin?r("b-container",[r("b-row",{staticClass:"footer-buttons"},[r("b-button",{attrs:{variant:"primary"}},[e._v("Protokolldaten herunterladen")])],1),r("b-row",{staticClass:"mt-3 footer-buttons"},[r("b-button",{attrs:{variant:"primary",to:"sessions/new"}},[e._v("Flugsession nachtragen")])],1)],1):e._e()],1)},ve=[],ge={name:"Sessions",data:function(){return{items:[],fieldsDesktop:[{key:"session_id",label:"ID"},{key:"pilot_name",label:"Pilot"},{key:"date",label:"Datum",formatter:function(e){return new Date(e).toLocaleDateString()}},{key:"start_time",label:"Beginn"},{key:"end_time",label:"Ende"},{key:"session_leader",label:"Flugleiter",formatter:function(e){return e?"F":""}},{key:"guest_details",label:"Gast"},{key:"actions",label:""}],fieldsMobile:[{key:"pilot_name",label:"Pilot"},{key:"date",label:"Datum",formatter:function(e){return new Date(e).toLocaleDateString()}},{key:"session_time",label:"Zeitraum"},{key:"session_leader",label:"Flugleiter",formatter:function(e){return e?"Ja":"Nein"}},{key:"guest",label:"Gast"},{key:"actions",label:"",class:"text-center"}],startDate:new Date,endDate:new Date,maxDate:new Date,filteredSessions:!1,pilotName:null,perPage:10,currentPage:1,sessionCount:0,sessionLoader:!1,sessionState:null,userInfo:{is_admin:!1}}},methods:{getSessions:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var r,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.sessionLoader=!0,r=(e.currentPage-1)*e.perPage+1,i=r+e.perPage-1,a="/sessions?from="+r+"&to="+i,e.filteredSessions&&(a+="&start_date="+new Date(e.startDate).toISOString().split("T")[0]+"&end_date="+new Date(e.endDate).toISOString().split("T")[0],null!=e.pilotName&&(a+="&name="+e.pilotName)),t.next=7,e.$axios.get(a).then((function(t){e.items=t.data["sessions"],e.sessionCount=t.data["session_count"],e.sessionLoader=!1}),(function(t){console.error(t),e.sessionLoader=!1,e.sessionState=!1}));case 7:case"end":return t.stop()}}),t)})))()},canEdit:function(e){return!!this.userInfo.is_admin||this.userInfo.id==e}},watch:{currentPage:function(){this.getSessions()}},mounted:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.userInfo=JSON.parse(e.$store.getters.userInfo),e.getSessions();case 2:case"end":return t.stop()}}),t)})))()}},he=ge,we=Object(g["a"])(he,pe,ve,!1,null,null,null),_e=we.exports,ke=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"new-pilot"},[r("Pilot",{attrs:{header:"Pilot erstellen",submitText:"Speichern",states:e.validateAll(),submit:e.submit,rfidList:e.rfidList,pilot:e.pilot,username:e.username},on:{formSubmit:e.onSubmit,setUsername:e.setUsername},scopedSlots:e._u([{key:"alerts",fn:function(){return[r("b-alert",{attrs:{variant:"success",show:e.submit.submitState}},[e._v(" Pilot wurde erfolgreich angelegt!"),r("br"),r("br"),r("b-button",{attrs:{variant:"success"},on:{click:function(t){return e.resetPilot()}}},[e._v("Weiteren Piloten erstellen")])],1),r("b-alert",{attrs:{variant:"info",show:e.rfidList.noRfid}},[e._v(" Kein freier RFID-Tag verfügbar! Fügen Sie dem System einen neuen RFID-Tag hinzu, bevor sie einen Piloten erstellen."),r("br"),r("br"),r("b-button",{attrs:{variant:"info",to:"settings?rfid_tags"}},[e._v("RFID-Tag hinzufügen")])],1),r("b-alert",{attrs:{variant:"danger",show:0==e.submit.submitState,dismissible:""}},[e._v(" Pilot konnte nicht angelegt werden!"),r("br"),e._v(" "+e._s(e.submit.submitErrorMsg)+" ")])]},proxy:!0}]),model:{value:e.$v.form,callback:function(t){e.$set(e.$v,"form",t)},expression:"$v.form"}})],1)},xe=[],Le=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"pilot"},[r("h2",[e._v(e._s(e.header))]),r("b-alert",{attrs:{variant:"danger",show:0==e.rfidList.rfidListState,dismissible:""}},[e._v(" RFID-Kennungen konnten nicht geladen werden! ")]),e._t("alerts"),r("b-container",{attrs:{fluid:"md"}},[r("b-row",{staticClass:"justify-content-center"},[r("b-col",{attrs:{lg:"10"}},[r("b-overlay",{attrs:{show:e.pilot.pilotLoader}},[r("b-form",{directives:[{name:"show",rawName:"v-show",value:e.formShow(),expression:"formShow()"}],attrs:{novalidate:!0},on:{submit:e.onSubmit}},[r("h4",[e._v("Pilotendaten")]),r("b-row",{attrs:{cols:"2"}},[r("b-col",{attrs:{cols:"12",md:"6"}},[r("b-form-group",{attrs:{label:"Vorname","label-for":"pilot-name-input"}},[r("b-form-input",{attrs:{id:"pilot-name-input",state:e.states.pilotName,debounce:"500",autocomplete:"off"},on:{change:function(t){return e.onChange()}},model:{value:e.value.pilotName.$model,callback:function(t){e.$set(e.value.pilotName,"$model","string"===typeof t?t.trim():t)},expression:"value.pilotName.$model"}}),e.value.pilotUsername.maxLength?e._e():r("b-form-invalid-feedback",[e._v(" Vorname zu lang! ")]),r("b-form-invalid-feedback",[e._v(" Ungültiger Vorname! ")])],1)],1),r("b-col",{attrs:{cols:"12",md:"6"}},[r("b-form-group",{attrs:{label:"Nachname","label-for":"pilot-surname-input"}},[r("b-form-input",{attrs:{id:"pilot-surname-input",state:e.states.pilotSurname,decounce:"500",autocomplete:"off"},on:{change:function(t){return e.onChange()}},model:{value:e.value.pilotSurname.$model,callback:function(t){e.$set(e.value.pilotSurname,"$model","string"===typeof t?t.trim():t)},expression:"value.pilotSurname.$model"}}),e.value.pilotSurname.maxLength?e._e():r("b-form-invalid-feedback",[e._v(" Nachname zu lang! ")]),r("b-form-invalid-feedback",[e._v(" Ungültiger Nachname! ")])],1)],1),r("b-col",{attrs:{cols:"12",md:"6"}},[r("b-form-group",{attrs:{label:"RFID-Kennung","label-for":"rfid-select"}},[r("b-overlay",{attrs:{show:e.rfidList.rfidListLoader,"spinner-type":"grow","spinner-small":""}},[r("b-form-select",{attrs:{required:"",id:"rfid-select",state:e.states.rfid,options:e.rfidList.rfidList},model:{value:e.value.rfid.$model,callback:function(t){e.$set(e.value.rfid,"$model","string"===typeof t?t.trim():t)},expression:"value.rfid.$model"}}),r("b-form-invalid-feedback",{attrs:{id:"input-live-feedback",state:e.states.rfid}},[e._v(" Ungültige RFID-Kennung ")])],1)],1)],1)],1),r("h4",[e._v("Login-Informationen")]),r("b-row",[r("b-col",{attrs:{cols:"12"}},[r("b-form-group",{attrs:{"label-for":"pilot-username-input",description:"Der Pilot vergibt das Passwort beim ersten Anmeldeversuch selbst."}},[r("div",{staticClass:"mt-2 mb-2"},[e._v(" Nutzername: "),r("b-spinner",{directives:[{name:"show",rawName:"v-show",value:e.username.pilotUsernameLoader,expression:"username.pilotUsernameLoader"}],attrs:{small:"",type:"grow",label:"Small Spinner"}}),r("span",{staticClass:"font-weight-bold"},[e._v(" "+e._s(e.value.pilotUsername.$model)+" ")])],1),r("b-form-invalid-feedback",{attrs:{state:0!=e.username.pilotUsernameState}},[e._v(" Nutzernamen konnten nicht geladen werden! ")])],1),r("b-form-checkbox",{attrs:{id:"admin-checkbox",name:"admin-checkbox"},model:{value:e.value.isAdmin.$model,callback:function(t){e.$set(e.value.isAdmin,"$model",t)},expression:"value.isAdmin.$model"}},[e._v(" Pilot hat Adminrechte ")]),e._t("login-form")],2)],1),r("div",{staticClass:"footer-buttons"},[r("b-button",{staticClass:"mt-3",attrs:{type:"submit",variant:"primary",disabled:e.submit.submitLoader}},[r("b-spinner",{directives:[{name:"show",rawName:"v-show",value:e.submit.submitLoader,expression:"submit.submitLoader"}],attrs:{small:""}}),e._v(" "+e._s(e.submitText)+" ")],1)],1)],1)],1)],1)],1)],1)],2)},Se=[],$e={name:"Pilot",props:["header","submitText","value","states","submit","rfidList","pilot","username"],methods:{onSubmit:function(e){e.preventDefault(),this.$emit("formSubmit",e)},onChange:function(){this.$emit("setUsername")},formShow:function(){return 0!=this.pilot.pilotState&&(1!=this.submit.submitState&&1!=this.rfidList.noRfid)}}},ye=$e,Pe=Object(g["a"])(ye,Le,Se,!1,null,null,null),Re=Pe.exports,Ne=(r("5319"),j["helpers"].regex("surnameRegex",/^([a-z]+ )*([A-Z][a-záàéèöäüß]+)([-]([A-Z][a-záàéèöäüß]+))*$/)),Ce=j["helpers"].regex("nameRegex",/^([A-Z][a-záàéèöäüß]+)([- ]([A-Z][a-záàéèöäüß]+))*$/),De={data:function(){return{form:{pilotSurname:null,pilotName:null,pilotUsername:null,rfid:null,isAdmin:!1},submit:{submitLoader:!1,submitState:null,submitErrorMsg:null},rfidList:{rfidListLoader:!1,rfidListState:null,rfidList:[],noRfid:!1},pilot:{pilotLoader:!1,pilotState:null},username:{pilotUsernames:[],pilotUsernameLoader:!1,pilotUsernameState:null}}},validations:{form:{pilotSurname:{required:j["required"],surnameRegex:Ne,maxLength:Object(j["maxLength"])(50)},pilotName:{required:j["required"],nameRegex:Ce,maxLength:Object(j["maxLength"])(50)},pilotUsername:{},rfid:{required:j["required"]},isAdmin:{}}},watch:{"rfidList.rfidList":function(){this.rfidList.noRfid=0==this.rfidList.rfidList.length},"form.pilotName":function(){this.setUsername()},"form.pilotSurname":function(){this.setUsername()}},methods:{validateAll:function(){var e={};for(var t in this.form)e[t]=this.validateState(t);return e},setUsername:function(){var e=this.form.pilotName,t=this.form.pilotSurname,r="";if(null!=e&&null!=t){if(e=e.toLowerCase().replace(" ","_"),t=t.toLowerCase().replace(" ","_"),r=e+"_"+t,this.username.pilotUsernames.includes(r)){var i=1;do{i++}while(this.username.pilotUsernames.includes(r+i));r+=i}this.form.pilotUsername=r}},submitSuccess:function(){this.submit.submitLoader=!1,this.submit.submitState=!0,this.form.pilotSurname=null,this.form.pilotName=null,this.form.pilotUsername=null,this.form.rfid=null,this.form.isAdmin=!1},submitFailure:function(e){console.error(e),this.submit.submitLoader=!1,this.submit.submitState=!1,this.submit.submitErrorMsg=e},getRfidList:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){e.rfidList.rfidListLoader=!0,e.$axios.get("/rfid_available").then((function(r){var i=r.data["rfid_list"];e.rfidList.rfidList=[];for(var a=0;a<i.length;a++)e.rfidList.rfidList.push(r.data["rfid_list"][a]);e.rfidList.rfidListLoader=!1,t()})).catch((function(t){console.error(t),e.rfidList.rfidListLoader=!1,e.rfidList.rfidListState=!1,r()}))})));case 1:case"end":return t.stop()}}),t)})))()},getPilotUsernames:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){e.username.pilotUsernameLoader=!0,e.$axios.get("/pilot-list").then((function(r){e.username.pilotUsernames=r.data["pilots"].map((function(t){return t.pilot_id==e.pilotId?null:t.pilot_username})),e.username.pilotUsernameLoader=!1,t()})).catch((function(t){console.error(t),e.username.pilotUsernameLoader=!1,e.username.pilotUsernameState=!1,r()}))})));case 1:case"end":return t.stop()}}),t)})))()}}},ze={name:"NewPilot",mixins:[De,T],components:{Pilot:Re},methods:{resetPilot:function(){this.submit.submitState=null,this.$v.$reset()},onSubmit:function(e){this.validateSubmit(e)&&this.newPilot()},newPilot:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.submit.submitLoader=!0,r={pilot_name:e.form.pilotName,pilot_surname:e.form.pilotSurname,rfid:e.form.rfid,pilot_username:e.form.pilotUsername,is_admin:e.form.isAdmin},t.next=4,e.$axios.post("/pilots",r).then((function(){e.submitSuccess(),e.getRfidList(),e.getPilotUsernames()})).catch((function(t){e.submitFailure(t)}));case 4:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.getRfidList(),this.getPilotUsernames()}},Te=ze,Ie=Object(g["a"])(Te,ke,xe,!1,null,null,null),Ae=Ie.exports,Oe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"modify-pilot"},[r("Pilot",{attrs:{header:"Pilot bearbeiten",submitText:"Speichern",states:e.validateAll(),submit:e.submit,rfidList:e.rfidList,pilot:e.pilot,username:e.username},on:{formSubmit:e.onSubmit,setUsername:e.setUsername},scopedSlots:e._u([{key:"alerts",fn:function(){return[r("b-alert",{attrs:{variant:"success",show:e.submit.submitState}},[e._v(" Pilot wurde erfolgreich bearbeitet!"),r("br"),r("br"),e._v(" Weiterleitung zur Pilotenübersicht... ")]),r("b-alert",{attrs:{variant:"danger",show:0==e.submit.submitState,dismissible:""}},[e._v(" Pilot konnte nicht bearbeitet werden!"),r("br"),e._v(" "+e._s(e.submit.submitErrorMsg)+" ")]),r("b-alert",{attrs:{variant:"danger",show:0==e.pilot.pilotState}},[e._v(" Der angeforderte Pilot konnte nicht geladen werden! ")])]},proxy:!0},{key:"login-form",fn:function(){return[r("b-form-checkbox",{staticClass:"mt-2",attrs:{id:"reset-pwd-checkbox",name:"reset-pwd-checkbox"},model:{value:e.resetPassword,callback:function(t){e.resetPassword=t},expression:"resetPassword"}},[e._v(" Passwort zurücksetzen ")])]},proxy:!0}]),model:{value:e.$v.form,callback:function(t){e.$set(e.$v,"form",t)},expression:"$v.form"}})],1)},je=[],Fe={name:"EditPilot",mixins:[De,T],components:{Pilot:Re},data:function(){return{pilotId:null,resetPassword:!1}},mounted:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.pilotId=e.$route.query.id,e.pilot.pilotLoader=!0,t.next=4,e.getRfidList();case 4:return t.next=6,e.getPilotUsernames();case 6:return t.next=8,e.$axios.get("/pilots?id="+e.pilotId).then((function(t){e.pilot.pilotLoader=!1;var r=t.data["pilots"][0];e.form.pilotSurname=r.pilot_surname,e.form.pilotName=r.pilot_name,e.form.pilotUsername=r.pilot_username,e.form.isAdmin=r.is_admin,e.rfidList.rfidList.unshift(r.rfid),e.form.rfid=r.rfid})).catch((function(t){e.pilot.pilotLoader=!1,e.pilot.pilotState=!1,console.error(t)}));case 8:case"end":return t.stop()}}),t)})))()},methods:{onSubmit:function(e){this.validateSubmit(e)&&this.editPilot()},editPilot:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.submit.submitLoader=!0,r={pilot_id:e.pilotId,pilot_name:e.form.pilotName,pilot_surname:e.form.pilotSurname,rfid:e.form.rfid,pilot_username:e.form.pilotUsername,reset_password:e.resetPassword,is_admin:e.form.isAdmin},t.next=4,e.$axios.put("/pilots",r).then((function(){e.submitSuccess(),e.resetPassword=!1,setTimeout((function(){e.$router.push("/pilots")}),3e3)})).catch((function(t){e.submitFailure(t)}));case 4:case"end":return t.stop()}}),t)})))()}}},qe=Fe,Ue=Object(g["a"])(qe,Oe,je,!1,null,null,null),Ee=Ue.exports,Me=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"reactivate-pilot"},[r("Pilot",{attrs:{header:"Pilot reaktivieren",submitText:"Reaktivieren",states:e.validateAll(),submit:e.submit,rfidList:e.rfidList,pilot:e.pilot,username:e.username},on:{formSubmit:e.onSubmit,setUsername:e.setUsername},scopedSlots:e._u([{key:"alerts",fn:function(){return[r("b-alert",{attrs:{variant:"success",show:e.submit.submitState}},[e._v(" Pilot wurde erfolgreich reaktiviert!"),r("br"),r("br"),e._v(" Weiterleitung zur Pilotenübersicht... ")]),r("b-alert",{attrs:{variant:"danger",show:0==e.submit.submitState,dismissible:""}},[e._v(" Pilot konnte nicht reaktiviert werden!"),r("br"),e._v(" "+e._s(e.submit.submitErrorMsg)+" ")]),r("b-alert",{attrs:{variant:"danger",show:0==e.pilot.pilotState}},[e._v(" Der angeforderte Pilot existiert nicht oder ist bereits aktiviert! ")])]},proxy:!0},{key:"login-form",fn:function(){return[r("b-form-checkbox",{staticClass:"mt-2",attrs:{id:"reset-pwd-checkbox",name:"reset-pwd-checkbox"},model:{value:e.resetPassword,callback:function(t){e.resetPassword=t},expression:"resetPassword"}},[e._v(" Passwort zurücksetzen ")])]},proxy:!0}]),model:{value:e.$v.form,callback:function(t){e.$set(e.$v,"form",t)},expression:"$v.form"}})],1)},Be=[],Ze={name:"ReactivatePilot",mixins:[De,T],components:{Pilot:Re},data:function(){return{pilotId:null,resetPassword:!1}},mounted:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.pilotId=e.$route.query.id,e.pilot.pilotLoader=!0,t.next=4,e.getRfidList();case 4:return t.next=6,e.getPilotUsernames();case 6:return t.next=8,e.$axios.get("/pilots?id="+e.pilotId+"&is_active=false").then((function(t){e.pilot.pilotLoader=!1;var r=t.data["pilots"][0];e.form.pilotSurname=r.pilot_surname,e.form.pilotName=r.pilot_name,e.form.pilotUsername=r.pilot_username,e.form.isAdmin=r.is_admin})).catch((function(t){e.pilot.pilotLoader=!1,e.pilot.pilotState=!1,console.error(t)}));case 8:case"end":return t.stop()}}),t)})))()},methods:{onSubmit:function(e){this.validateSubmit(e)&&this.reactivatePilot()},reactivatePilot:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.submit.submitLoader=!0,r={pilot_id:e.pilotId,pilot_name:e.form.pilotName,pilot_surname:e.form.pilotSurname,rfid:e.form.rfid,pilot_username:e.form.pilotUsername,reset_password:e.resetPassword,is_admin:e.form.isAdmin,is_active:!0},t.next=4,e.$axios.put("/pilots",r).then((function(){e.submitSuccess(),e.resetPassword=!1,setTimeout((function(){e.$router.push("/pilots")}),3e3)})).catch((function(t){e.submitFailure(t)}));case 4:case"end":return t.stop()}}),t)})))()}}},Ge=Ze,Je=Object(g["a"])(Ge,Me,Be,!1,null,null,null),Ke=Je.exports,He=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"settings"},[r("b-modal",{attrs:{id:"pilot-checkout-modal",title:"Uhrzeit der täglichen Pilotenabmeldung"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("b-button",{attrs:{variant:"secondary"},on:{click:function(t){return e.$bvModal.hide("pilot-checkout-modal")}}},[e._v("Abbrechen")]),r("b-button",{attrs:{disabled:e.submitLoader,variant:"primary"},on:{click:function(t){return e.submitSetttings("pilot-checkout-modal")}}},[r("b-spinner",{directives:[{name:"show",rawName:"v-show",value:e.submitLoader,expression:"submitLoader"}],attrs:{small:""}}),e._v(" Speichern ")],1)]},proxy:!0}])},[r("b-form-group",{attrs:{id:"pilot-checkout-group",label:"Uhrzeit auswählen","label-for":"pilot-checkout-time-input"}},[r("b-form-input",{attrs:{id:"pilot-checkout-time-input",type:"time"},model:{value:e.settings.checkout_time,callback:function(t){e.$set(e.settings,"checkout_time",t)},expression:"settings.checkout_time"}})],1)],1),r("b-modal",{attrs:{id:"rfid-tag-modal",size:"lg",title:"RFID-Tags verwalten"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.$bvModal.hide("rfid-tag-modal")}}},[e._v(" OK ")])]},proxy:!0}])},[r("b-container",{attrs:{fluid:""}},[r("b-form",[r("b-row",{staticClass:"justify-content-center"},[r("b-col",[r("b-alert",{attrs:{variant:"success",show:e.addRfidState}},[e._v(" RFID-Tag wurde erfolgreich hinzugefügt ")]),r("b-alert",{attrs:{variant:"danger",show:0==e.addRfidState}},[e._v(" RFID-Tag konnte nicht hinzugefügt werden! ")]),r("b-form",{attrs:{novalidate:!0},on:{submit:e.onSubmitRfidTag}},[r("b-form-group",{attrs:{id:"rfid-input-group",label:"RFID-Tag hinzufügen","label-for":"rfid-input"}},[r("b-input-group",{attrs:{id:"rfid-input",prepend:"0x"}},[r("b-form-input",{attrs:{state:e.validateState("rfidTag")},model:{value:e.$v.form.rfidTag.$model,callback:function(t){e.$set(e.$v.form.rfidTag,"$model","string"===typeof t?t.trim():t)},expression:"$v.form.rfidTag.$model"}}),r("b-input-group-append",[r("b-button",{attrs:{variant:"success",type:"submit",disabled:e.addRfidLoader}},[r("b-spinner",{directives:[{name:"show",rawName:"v-show",value:e.addRfidLoader,expression:"addRfidLoader"}],attrs:{small:""}}),r("b-icon-plus",{directives:[{name:"show",rawName:"v-show",value:!e.addRfidLoader,expression:"!addRfidLoader"}],attrs:{scale:"1.5"}}),e._v(" Hinzufügen ")],1)],1)],1),r("b-form-invalid-feedback",{attrs:{state:e.validateState("rfidTag")}},[e._v(" Ungültiger RFID-Tag! RFID-Tag muss hexadezimal angegeben werden! ")])],1)],1)],1)],1),r("b-row",{staticClass:"justify-content-center"},[r("b-col",{attrs:{cols:"12",md:"6"}},[r("b-form-group",{attrs:{id:"free-rfid-group",label:"Frei","label-for":"free-rfid-table"}},[r("b-overlay",{attrs:{show:e.freeRfidLoader,"spinner-type":"grow"}},[r("b-table",{attrs:{"sticky-header":"",items:e.freeRfidList,fields:e.freeRfidFields,"head-variant":"light"},scopedSlots:e._u([{key:"cell()",fn:function(t){return[e._v(" "+e._s(t.item)+" ")]}}])})],1)],1)],1),r("b-col",[r("b-form-group",{attrs:{id:"used-rfid-group",label:"Vergeben","label-for":"used-rfid-table"}},[r("b-overlay",{attrs:{show:e.usedRfidLoader,"spinner-type":"grow"}},[r("b-table",{attrs:{"sticky-header":"",items:e.usedRfidList,fields:e.usedRfidFields,"head-variant":"light"}})],1)],1)],1)],1)],1)],1)],1),r("b-modal",{attrs:{id:"terminal-config-modal",size:"lg",title:"Tasten- & Bedienkonfiguration"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("b-button",{attrs:{variant:"secondary"},on:{click:function(t){return e.$bvModal.hide("terminal-config-modal")}}},[e._v("Abbrechen")]),r("b-button",{attrs:{disabled:e.submitLoader,variant:"primary"},on:{click:function(t){return e.submitSetttings("terminal-config-modal")}}},[r("b-spinner",{directives:[{name:"show",rawName:"v-show",value:e.submitLoader,expression:"submitLoader"}],attrs:{small:""}}),e._v(" Speichern ")],1)]},proxy:!0}])},[r("b-container",e._l(e.settings.terminal_config,(function(t){return r("b-row",{key:t.name,staticClass:"align-items-center",attrs:{cols:"3"}},[r("b-col",{staticClass:"pl-0",attrs:{cols:"12",lg:"2"}},[e._v(" "+e._s(t.name)+": ")]),r("b-col",{staticClass:"d-flex align-items-center py-2 px-0",attrs:{cols:"12",md:"6",lg:"5"}},[r("b-input-group",{staticClass:"mr-3",attrs:{append:"Sek"}},[r("b-form-input",{attrs:{min:"0",type:"number"},model:{value:t.duration,callback:function(r){e.$set(t,"duration",r)},expression:"config.duration"}})],1),r("b-form-checkbox",{staticClass:"mr-3",model:{value:t.button,callback:function(r){e.$set(t,"button",r)},expression:"config.button"}},[e._v(" Taster ")])],1),r("b-col",{staticClass:"d-flex align-items-center py-2 px-0",attrs:{cols:"12",md:"6",lg:"5"}},[r("b-input-group",{staticClass:"mr-3",attrs:{append:"LED"}},[r("b-form-input",{attrs:{type:"color"},model:{value:t.color,callback:function(r){e.$set(t,"color",r)},expression:"config.color"}})],1),r("b-form-checkbox",{model:{value:t.blinking,callback:function(r){e.$set(t,"blinking",r)},expression:"config.blinking"}},[e._v(" Blinken ")])],1)],1)})),1)],1),r("b-modal",{attrs:{id:"tolerance-time-modal",title:"Toleranzzeit bei An- & Abmeldung"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("b-button",{attrs:{variant:"secondary"},on:{click:function(t){return e.$bvModal.hide("tolerance-time-modal")}}},[e._v("Abbrechen")]),r("b-button",{attrs:{disabled:e.submitLoader,variant:"primary"},on:{click:function(t){return e.submitSetttings("tolerance-time-modal")}}},[r("b-spinner",{directives:[{name:"show",rawName:"v-show",value:e.submitLoader,expression:"submitLoader"}],attrs:{small:""}}),e._v(" Speichern ")],1)]},proxy:!0}])},[r("b-form-group",{attrs:{id:"tolerance-time-group",label:"Toleranzzeit auswählen","label-for":"tolerance-time-input"}},[r("b-input-group",{attrs:{append:"Min"}},[r("b-form-input",{attrs:{min:"0",id:"tolerance-time-input",type:"number"},model:{value:e.settings.tolerance,callback:function(t){e.$set(e.settings,"tolerance",t)},expression:"settings.tolerance"}})],1)],1)],1),r("h2",[e._v("Einstellungen")]),r("b-alert",{attrs:{variant:"success",show:e.submitState}},[e._v(" Einstellungen erfolgreich gespeichert ")]),r("b-alert",{attrs:{variant:"danger",show:0==e.submitState}},[e._v(" Einstellungen konnten nicht gespeichert werden! ")]),r("b-overlay",{attrs:{show:e.submitLoader,"spinner-type":"grow"}},[r("b-container",{attrs:{fluid:"md"}},[r("b-row",{staticClass:"justify-content-center"},[r("b-col",{attrs:{lg:"8"}},[r("br"),r("h4",[e._v("Allgemeine Einstellungen")]),r("b-row",{staticClass:"align-items-center",attrs:{cols:"2"}},[r("b-col",{staticClass:"py-2",attrs:{cols:"10",md:"8"}},[e._v(" Uhrzeit der täglichen Pilotenabmeldung ")]),r("b-col",{staticClass:"py-2 text-center",attrs:{cols:"2",md:"4"}},[r("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.pilot-checkout-modal",modifiers:{"pilot-checkout-modal":!0}}],attrs:{variant:"primary"}},[r("b-icon-pencil-square"),r("span",{staticClass:"ml-1 d-none d-md-inline"},[e._v("Bearbeiten")])],1)],1),r("b-col",{staticClass:"py-2",attrs:{cols:"10",md:"8"}},[e._v(" RFID-Kennungen verwalten ")]),r("b-col",{staticClass:"py-2 text-center",attrs:{cols:"2",md:"4"}},[r("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.rfid-tag-modal",modifiers:{"rfid-tag-modal":!0}}],attrs:{variant:"primary"}},[r("b-icon-pencil-square"),r("span",{staticClass:"ml-1 d-none d-md-inline"},[e._v("Bearbeiten")])],1)],1)],1),r("br"),r("h4",[e._v("Terminal")]),r("b-row",{staticClass:"align-items-center",attrs:{cols:"2"}},[r("b-col",{staticClass:"py-2",attrs:{cols:"10",md:"8"}},[e._v(" Tasten- & Bedienkonfiguration ")]),r("b-col",{staticClass:"py-2 text-center",attrs:{cols:"2",md:"4"}},[r("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.terminal-config-modal",modifiers:{"terminal-config-modal":!0}}],attrs:{variant:"primary"}},[r("b-icon-pencil-square"),r("span",{staticClass:"ml-1 d-none d-md-inline"},[e._v("Bearbeiten")])],1)],1),r("b-col",{staticClass:"py-2",attrs:{cols:"10",md:"8"}},[e._v(" Toleranzzeit bei An- & Abmeldung ")]),r("b-col",{staticClass:"py-2 text-center",attrs:{cols:"2",md:"4"}},[r("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.tolerance-time-modal",modifiers:{"tolerance-time-modal":!0}}],attrs:{variant:"primary"}},[r("b-icon-pencil-square"),r("span",{staticClass:"ml-1 d-none d-md-inline"},[e._v("Bearbeiten")])],1)],1)],1)],1)],1)],1)],1)],1)},Ve=[],We=(r("25f0"),{name:"Settings",mixins:[T],data:function(){return{form:{rfidTag:null},addRfidLoader:!1,freeRfidLoader:!1,usedRfidLoader:!1,addRfidState:null,freeRfidList:[],freeRfidFields:["RFID-Tags"],usedRfidList:[],usedRfidFields:[{key:"pilot_id",label:"ID"},{key:"pilot_name",label:"Pilot"},{key:"rfid",label:"RFID-Tag"}],settingsLoader:!1,settingsState:null,settings:{},submitState:null,submitLoader:!1}},validations:{form:{rfidTag:{required:j["required"],isHex:function(e){if(null==e)return!1;var t=parseInt(e,16);return t.toString(16)===e.toLowerCase()}}}},mounted:function(){var e=this.$route.query.rfid_tags;void 0!==e&&this.$bvModal.show("rfid-tag-modal"),this.getFreeRfidList(),this.getUsedRfidList(),this.getSettings()},methods:{submitSetttings:function(e){var t=this;return Object(y["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.postSettings();case 2:t.$bvModal.hide(e);case 3:case"end":return r.stop()}}),r)})))()},onSubmitRfidTag:function(e){this.validateSubmit(e)&&this.addRfidTag()},addRfidTag:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.addRfidLoader=!0,r={rfid:e.form.rfidTag},e.$axios.post("/rfid",r).then((function(){e.addRfidLoader=!1,e.addRfidState=!0,e.form.rfidTag=null,e.$v.$reset(),e.getFreeRfidList()})).catch((function(){e.addRfidLoader=!1,e.addRfidState=!1}));case 3:case"end":return t.stop()}}),t)})))()},getSettings:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.settingsLoader=!0,e.$axios.get("/settings").then((function(t){e.settings=t.data["settings"],e.settingsState=!0,e.settingsLoader=!1})).catch((function(t){console.error(t),e.settingsState=!1,e.settingsLoader=!1}));case 2:case"end":return t.stop()}}),t)})))()},postSettings:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.submitLoader=!0,e.$axios.post("/settings",e.settings).then((function(){e.submitState=!0,e.submitLoader=!1})).catch((function(t){console.error(t),e.submitState=!1,e.submitLoader=!1}));case 2:case"end":return t.stop()}}),t)})))()},getFreeRfidList:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.freeRfidLoader=!0,e.$axios.get("/rfid_available").then((function(t){e.freeRfidList=t.data["rfid_list"],e.freeRfidLoader=!1})).catch((function(t){console.error(t),e.freeRfidLoader=!1}));case 2:case"end":return t.stop()}}),t)})))()},getUsedRfidList:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.usedRfidLoader=!0,e.$axios.get("/rfid_assigned").then((function(t){e.usedRfidList=t.data["rfid_list"],e.usedRfidLoader=!1})).catch((function(t){console.error(t),e.usedRfidLoader=!1}));case 2:case"end":return t.stop()}}),t)})))()}}}),Qe=We,Xe=Object(g["a"])(Qe,He,Ve,!1,null,null,null),Ye=Xe.exports;i["default"].use(c["a"]);var et=[{path:"/",name:"Home",component:C,meta:{requiresAuth:!0,roles:["admin","pilot"]}},{path:"/login",name:"Login",component:E,meta:{requiresAuth:!1}},{path:"/signup",name:"Signup",component:K,meta:{requiresAuth:!1}},{path:"/pilots",name:"PilotOverview",component:Y,meta:{requiresAuth:!0,roles:["admin"]}},{path:"/sessions/new",name:"NewSession",component:oe,meta:{requiresAuth:!0,roles:["admin"]}},{path:"/sessions/edit",name:"EditSession",component:be,meta:{requiresAuth:!0,roles:["admin","pilot"]}},{path:"/sessions",name:"ProtocolOverview",component:_e,meta:{requiresAuth:!0,roles:["admin","pilot"]}},{path:"/pilots/new",name:"NewPilot",component:Ae,meta:{requiresAuth:!0,roles:["admin"]}},{path:"/pilots/edit",name:"EditPilot",component:Ee,meta:{requiresAuth:!0,roles:["admin"]}},{path:"/pilots/reactivate",name:"ReactivatePilot",component:Ke,meta:{requiresAuth:!0,roles:["admin"]}},{path:"/settings",name:"Settings",component:Ye,meta:{requiresAuth:!0,roles:["admin"]}}],tt=new c["a"]({mode:"history",base:"/",routes:et});tt.beforeEach((function(e,t,r){if(!e.meta.requiresAuth)return r();if(d.getters.isLoggedIn){var i=JSON.parse(d.getters.userInfo);if(i.is_admin)return r();if(e.meta.roles.includes("pilot"))return r()}return r("/login")}));var rt=tt,it=r("5f5b"),at=r("b1e0"),st=r("1dce"),nt=r.n(st);r("f9e3"),r("2dd8");i["default"].use(it["a"]),i["default"].use(at["a"]),i["default"].use(nt.a);var ot=m.a,lt=localStorage.getItem("token");lt&&(ot.defaults.headers.common["token"]=lt),ot.defaults.baseURL="/api",i["default"].prototype.$axios=ot,new i["default"]({router:rt,store:d,render:function(e){return e(L)}}).$mount("#app")},6:function(e,t){},7:function(e,t){},8:function(e,t){},"85ec":function(e,t,r){},9:function(e,t){},a6bf:function(e,t,r){"use strict";r("cc7a")},cc7a:function(e,t,r){},f34c:function(e,t,r){}});
//# sourceMappingURL=app.f1a4a4fd.js.map